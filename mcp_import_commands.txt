# MCP Supabase Import Commands
# Run these commands in sequence to import all data

# 1. First, disable triggers (run once)
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "ALTER TABLE pos_orders DISABLE TRIGGER handle_pos_orders_user_id_trigger; ALTER TABLE pos_orders DISABLE TRIGGER set_tenant_id_pos_orders;"
})

# 2. Clear existing data (optional - run if you want to start fresh)
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "DELETE FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b' AND date >= '2025-03-31'::date;"
})

# 3. Import batches (run each batch command)

# Batch 1: batch_001_invoices_1_to_10.sql
# Read the file content and execute:
with open('batch_001_invoices_1_to_10.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 1
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 2: batch_002_invoices_11_to_20.sql
# Read the file content and execute:
with open('batch_002_invoices_11_to_20.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 2
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 3: batch_003_invoices_21_to_30.sql
# Read the file content and execute:
with open('batch_003_invoices_21_to_30.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 3
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 4: batch_004_invoices_31_to_40.sql
# Read the file content and execute:
with open('batch_004_invoices_31_to_40.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 4
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 5: batch_005_invoices_41_to_50.sql
# Read the file content and execute:
with open('batch_005_invoices_41_to_50.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 5
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 6: batch_006_invoices_51_to_60.sql
# Read the file content and execute:
with open('batch_006_invoices_51_to_60.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 6
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 7: batch_007_invoices_61_to_70.sql
# Read the file content and execute:
with open('batch_007_invoices_61_to_70.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 7
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 8: batch_008_invoices_71_to_80.sql
# Read the file content and execute:
with open('batch_008_invoices_71_to_80.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 8
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 9: batch_009_invoices_81_to_90.sql
# Read the file content and execute:
with open('batch_009_invoices_81_to_90.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 9
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 10: batch_010_invoices_91_to_100.sql
# Read the file content and execute:
with open('batch_010_invoices_91_to_100.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 10
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 11: batch_011_invoices_101_to_110.sql
# Read the file content and execute:
with open('batch_011_invoices_101_to_110.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 11
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 12: batch_012_invoices_111_to_120.sql
# Read the file content and execute:
with open('batch_012_invoices_111_to_120.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 12
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 13: batch_013_invoices_121_to_130.sql
# Read the file content and execute:
with open('batch_013_invoices_121_to_130.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 13
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 14: batch_014_invoices_131_to_140.sql
# Read the file content and execute:
with open('batch_014_invoices_131_to_140.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 14
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 15: batch_015_invoices_141_to_150.sql
# Read the file content and execute:
with open('batch_015_invoices_141_to_150.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 15
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 16: batch_016_invoices_151_to_160.sql
# Read the file content and execute:
with open('batch_016_invoices_151_to_160.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 16
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 17: batch_017_invoices_161_to_170.sql
# Read the file content and execute:
with open('batch_017_invoices_161_to_170.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 17
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 18: batch_018_invoices_171_to_180.sql
# Read the file content and execute:
with open('batch_018_invoices_171_to_180.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 18
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 19: batch_019_invoices_181_to_190.sql
# Read the file content and execute:
with open('batch_019_invoices_181_to_190.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 19
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 20: batch_020_invoices_191_to_200.sql
# Read the file content and execute:
with open('batch_020_invoices_191_to_200.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 20
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 21: batch_021_invoices_201_to_210.sql
# Read the file content and execute:
with open('batch_021_invoices_201_to_210.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 21
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 22: batch_022_invoices_211_to_220.sql
# Read the file content and execute:
with open('batch_022_invoices_211_to_220.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 22
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 23: batch_023_invoices_221_to_230.sql
# Read the file content and execute:
with open('batch_023_invoices_221_to_230.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 23
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 24: batch_024_invoices_231_to_240.sql
# Read the file content and execute:
with open('batch_024_invoices_231_to_240.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 24
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 25: batch_025_invoices_241_to_250.sql
# Read the file content and execute:
with open('batch_025_invoices_241_to_250.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 25
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 26: batch_026_invoices_251_to_260.sql
# Read the file content and execute:
with open('batch_026_invoices_251_to_260.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 26
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 27: batch_027_invoices_261_to_270.sql
# Read the file content and execute:
with open('batch_027_invoices_261_to_270.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 27
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 28: batch_028_invoices_271_to_280.sql
# Read the file content and execute:
with open('batch_028_invoices_271_to_280.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 28
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 29: batch_029_invoices_281_to_290.sql
# Read the file content and execute:
with open('batch_029_invoices_281_to_290.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 29
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 30: batch_030_invoices_291_to_300.sql
# Read the file content and execute:
with open('batch_030_invoices_291_to_300.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 30
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 31: batch_031_invoices_301_to_310.sql
# Read the file content and execute:
with open('batch_031_invoices_301_to_310.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 31
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 32: batch_032_invoices_311_to_320.sql
# Read the file content and execute:
with open('batch_032_invoices_311_to_320.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 32
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 33: batch_033_invoices_321_to_330.sql
# Read the file content and execute:
with open('batch_033_invoices_321_to_330.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 33
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 34: batch_034_invoices_331_to_340.sql
# Read the file content and execute:
with open('batch_034_invoices_331_to_340.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 34
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 35: batch_035_invoices_341_to_350.sql
# Read the file content and execute:
with open('batch_035_invoices_341_to_350.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 35
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 36: batch_036_invoices_351_to_360.sql
# Read the file content and execute:
with open('batch_036_invoices_351_to_360.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 36
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 37: batch_037_invoices_361_to_370.sql
# Read the file content and execute:
with open('batch_037_invoices_361_to_370.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 37
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# Batch 38: batch_038_invoices_371_to_376.sql
# Read the file content and execute:
with open('batch_038_invoices_371_to_376.sql', 'r', encoding='utf-8') as f:
    batch_sql = f.read()
    
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": batch_sql
})

# Check progress after batch 38
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "SELECT COUNT(*) as imported_count, SUM(total_amount) as total_revenue FROM pos_orders WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';"
})

# 4. Final verification
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": """
    SELECT 
        COUNT(*) as total_imported,
        SUM(total_amount) as total_revenue,
        COUNT(DISTINCT client_name) as unique_clients,
        COUNT(DISTINCT stylist_name) as unique_stylists,
        MIN(date) as earliest_date,
        MAX(date) as latest_date
    FROM pos_orders 
    WHERE user_id = '3f4b718f-70cb-4873-a62c-b8806a92e25b';
    """
})

# 5. Re-enable triggers (run once at the end)
mcp_supabase_execute_sql({
    "project_id": "mtyudylsozncvilibxda",
    "query": "ALTER TABLE pos_orders ENABLE TRIGGER handle_pos_orders_user_id_trigger; ALTER TABLE pos_orders ENABLE TRIGGER set_tenant_id_pos_orders;"
})
