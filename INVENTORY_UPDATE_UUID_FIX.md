# Inventory Update UUID Error Fix

## Problem
The inventory update feature was failing with the error:
```
invalid input syntax for type uuid: ""
```

## Root Cause
Two UUID-related issues were identified:

1. **Missing Product ID**: The `handleProductSelect` function in `InventoryManager.tsx` was not setting the `product_id` field when a product was selected, leaving it as an empty string from the initial form data.

2. **Invalid Purchase ID**: The `addInventoryUpdate` function was generating a string ID like `INV-1749573000-abc123` instead of letting the database auto-generate a proper UUID.

## Solution

### Fix 1: Set Product ID on Product Selection
**File**: `src/pages/InventoryManager.tsx`

Updated the `handleProductSelect` function to include the `product_id`:

```typescript
setPurchaseFormData(prev => ({
  ...prev,
  product_id: product.id || '', // Added: Set the product_id from the selected product
  product_name: product.name,
  hsn_code: product.hsn_code || '',
  // ... other fields
}));
```

### Fix 2: Let Database Auto-Generate Purchase ID
**File**: `src/hooks/usePurchaseHistory.ts`

Removed the manual `purchase_id` generation:

```typescript
// Before:
const inventoryId = `INV-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
const inventoryUpdatePayload = {
  purchase_id: inventoryId,
  // ...
};

// After:
const inventoryUpdatePayload = {
  // purchase_id: auto-generated by database as proper UUID
  // ...
};
```

## Result
The inventory update feature should now work correctly:
- Products can be selected properly with valid product IDs
- Purchase records are created with valid UUIDs
- No more "invalid input syntax for type uuid" errors

## Testing
To test the fix:
1. Go to Inventory Manager
2. Click "Update Inventory" button
3. Select a product from the dropdown
4. Fill in the quantity and other details
5. Submit the form
6. The inventory update should complete successfully without UUID errors 